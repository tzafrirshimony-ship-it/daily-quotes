<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>×”×’×¨×“ ×”×™×•××™</title>
    
    <!-- PWA Setup -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1e293b">
    <link rel="manifest" href="data:application/manifest+json,{'name':'×”×’×¨×“ ×”×™×•××™','display':'standalone','background_color':'#1e293b','theme_color':'#1e293b','icons':[{'src':'https://cdn-icons-png.flaticon.com/512/2662/2662503.png','sizes':'512x512','type':'image/png'}]}">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2662/2662503.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Rubik', sans-serif; background-color: #0f172a; color: white; overflow: hidden; }
        
        .scratch-container {
            position: relative;
            width: 320px;
            height: 320px;
            margin: 0 auto;
            border-radius: 1.5rem;
            overflow: hidden;
            box-shadow: 0 20px 50px -10px rgba(0,0,0,0.5);
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            cursor: pointer;
            touch-action: none; /* ×—×•×‘×” ×œ××•×‘×™×™×œ */
        }

        .hidden-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            padding: 2rem;
            text-align: center;
        }

        .streak-flame { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <!-- ××•× ×” ×”×¨×¦×£ -->
    <div class="absolute top-6 w-full flex justify-center">
        <div class="bg-slate-800/80 backdrop-blur border border-slate-700 rounded-full px-6 py-2 flex items-center gap-3 shadow-xl">
            <span class="text-3xl streak-flame">ğŸ”¥</span>
            <div class="text-right">
                <p class="text-2xl font-black text-amber-400 leading-none" id="streakCount">0</p>
                <p class="text-[10px] text-slate-400 font-bold uppercase tracking-wider">×™××™× ×‘×¨×¦×£</p>
            </div>
        </div>
    </div>

    <div class="text-center w-full max-w-sm">
        
        <h1 class="text-3xl font-black mb-2 text-slate-200">×”×’×¨×“ ×”×™×•××™</h1>
        <p class="text-slate-400 text-sm mb-8" id="instructions">×’×¨×“ ××ª ×”×›×¨×˜×™×¡ ×›×“×™ ×œ×’×œ×•×ª ××ª ×”××¡×¨</p>

        <!-- ××–×•×¨ ×”×’×™×¨×•×“ -->
        <div class="scratch-container" id="scratchCard">
            <!-- ×”×§× ×‘×¡ (×”×©×›×‘×” ×©××’×¨×“×™×) -->
            <canvas id="scratchCanvas"></canvas>
            
            <!-- ×”×ª×•×›×Ÿ ×”××•×¡×ª×¨ -->
            <div class="hidden-content flex flex-col">
                <span class="text-6xl mb-4">âœ¨</span>
                <p id="quoteText" class="text-2xl font-bold text-white drop-shadow-md leading-tight"></p>
                <p class="mt-4 text-xs font-bold text-amber-100 opacity-80 uppercase tracking-widest">×”××¡×¨ ×©×œ×š ×œ×”×™×•×</p>
            </div>
        </div>

        <!-- ×›×¤×ª×•×¨×™× ××—×¨×™ ×—×©×™×¤×” -->
        <div id="actions" class="mt-8 opacity-0 transition-opacity duration-1000 pointer-events-none">
            <button onclick="shareQuote()" class="bg-white text-slate-900 px-8 py-3 rounded-xl font-bold shadow-lg active:scale-95 transition w-full">
                ×©×ª×£ ××ª ×”×”×©×¨××” ×‘×•×•××˜×¡××¤
            </button>
            <p class="text-[10px] text-slate-500 mt-4">×—×–×•×¨ ××—×¨ ×›×“×™ ×œ× ×œ×©×‘×•×¨ ××ª ×”×¨×¦×£!</p>
        </div>

    </div>

    <script>
        const quotes = [
            "×”×¦×œ×—×” ×”×™× ×¡×›×•× ×©×œ ××××¦×™× ×§×˜× ×™× ×©×—×•×–×¨×™× ×¢×œ ×¢×¦×× ×™×•× ××—×¨ ×™×•×.",
            "××œ ×ª×ª×Ÿ ×œ×¤×—×“ ××›×™×©×œ×•×Ÿ ×œ×¢×¦×•×¨ ××•×ª×š ××œ×©×—×§ ××ª ×”××©×—×§.",
            "×”×“×¨×š ×”×›×™ ×˜×•×‘×” ×œ×—×–×•×ª ××ª ×”×¢×ª×™×“ ×”×™× ×œ×™×¦×•×¨ ××•×ª×•.",
            "××ª×” ×—×–×§ ×™×•×ª×¨ ××©× ×“××” ×œ×š, ×××™×¥ ×™×•×ª×¨ ××©××ª×” ××××™×Ÿ.",
            "×›×œ ×™×•× ×”×•× ×”×ª×—×œ×” ×—×“×©×”. ×§×— × ×©×™××” ×¢××•×§×” ×•×ª×ª×—×™×œ ××—×“×©.",
            "×”×× ×¨×’×™×” ×©××ª×” ××©×“×¨ ×”×™× ×”×× ×¨×’×™×” ×©××ª×” ××•×©×š.",
            "×¦×¢×“ ×§×˜×Ÿ ×”×™×•× ××•×‘×™×œ ×œ×©×™× ×•×™ ×’×“×•×œ ××—×¨."
        ];

        // ×œ×•×’×™×§×” ×©×œ ×¨×¦×£ (Streak)
        function checkStreak() {
            const today = new Date().toDateString();
            const lastVisit = localStorage.getItem('lastVisit');
            let streak = parseInt(localStorage.getItem('streak') || 0);

            if (lastVisit === today) {
                // ×›×‘×¨ ×‘×™×§×¨ ×”×™×•× - × ×©××™×¨ ××ª ×”×¨×¦×£
                document.getElementById('streakCount').innerText = streak;
                return true; // ×›×‘×¨ × ×—×©×£
            }

            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            
            if (lastVisit === yesterday.toDateString()) {
                // ×‘×™×§×¨ ××ª××•×œ - ×œ×”×¢×œ×•×ª ×¨×¦×£
                streak++;
            } else {
                // ×©×‘×¨ ×¨×¦×£ (××• ×¤×¢× ×¨××©×•× ×”)
                streak = 1;
            }

            localStorage.setItem('streak', streak);
            localStorage.setItem('lastVisit', today);
            document.getElementById('streakCount').innerText = streak;
            return false; // ×—×“×© ×œ×”×™×•×
        }

        // ×”×’×“×¨×ª ××©×¤×˜ ×™×•××™
        const now = new Date();
        const start = new Date(now.getFullYear(), 0, 0);
        const diff = now - start;
        const dayIdx = Math.floor(diff / (1000 * 60 * 60 * 24));
        const dailyQuote = quotes[dayIdx % quotes.length];
        document.getElementById('quoteText').innerText = dailyQuote;

        // ××ª×—×•×œ ×›×¨×˜×™×¡ ×’×™×¨×•×“
        const canvas = document.getElementById('scratchCanvas');
        const ctx = canvas.getContext('2d');
        const container = document.getElementById('scratchCard');
        
        // ×”×ª×××ª ×’×•×“×œ ×§× ×‘×¡
        canvas.width = container.offsetWidth;
        canvas.height = container.offsetHeight;

        // ××™×œ×•×™ ×”×§× ×‘×¡ ×‘"×›×™×¡×•×™" (×¦×‘×¢ ××¤×•×¨/×›×¡×£)
        const initCanvas = (isRevealed) => {
            if (isRevealed) {
                canvas.style.display = 'none';
                showActions();
                return;
            }

            ctx.fillStyle = '#334155'; // ×¦×‘×¢ ×”×¦×™×¤×•×™
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ×”×•×¡×¤×ª ×˜×§×¡×˜ ×¢×œ ×”×¦×™×¤×•×™
            ctx.fillStyle = '#94a3b8';
            ctx.font = 'bold 20px Rubik';
            ctx.textAlign = "center";
            ctx.fillText("×’×¨×“ ×›××Ÿ ×œ×’×™×œ×•×™", canvas.width/2, canvas.height/2);
            
            // ×”×•×¡×¤×ª ××™×™×§×•× ×™× ×œ×§×™×©×•×˜
            ctx.font = '40px Arial';
            ctx.fillText("â”", canvas.width/2, canvas.height/2 - 40);
        };

        const alreadyRevealed = checkStreak();
        // ×× ×”××©×ª××© ×›×‘×¨ ×‘×™×§×¨ ×”×™×•× - ×”×›×¨×˜×™×¡ ×›×‘×¨ ××’×•×¨×“
        // ×× ××ª×” ×¨×•×¦×” ×©×”×•× ×™×’×¨×“ ×›×œ ×¤×¢× ××—×“×© (××¤×™×œ×• ××ª ××•×ª×• ××©×¤×˜), ×©× ×” ×œ-false
        initCanvas(false); 

        // ×œ×•×’×™×§×ª ×’×™×¨×•×“
        let isDrawing = false;

        function getMousePos(canvas, evt) {
            const rect = canvas.getBoundingClientRect();
            return {
                x: (evt.clientX || evt.touches[0].clientX) - rect.left,
                y: (evt.clientY || evt.touches[0].clientY) - rect.top
            };
        }

        function scratch(e) {
            if (!isDrawing) return;
            e.preventDefault(); // ×× ×™×¢×ª ×’×œ×™×œ×” ×‘×˜×œ×¤×•×Ÿ
            
            const pos = getMousePos(canvas, e);
            
            ctx.globalCompositeOperation = 'destination-out';
            ctx.beginPath();
            ctx.arc(pos.x, pos.y, 25, 0, Math.PI * 2); // ×’×•×“×œ ×”××—×§
            ctx.fill();
            
            checkScratchPercent();
        }

        function startScratch(e) { isDrawing = true; scratch(e); }
        function endScratch() { isDrawing = false; }

        // ××™×¨×•×¢×™ ××’×¢ ×•×¢×›×‘×¨
        canvas.addEventListener('mousedown', startScratch);
        canvas.addEventListener('touchstart', startScratch);
        canvas.addEventListener('mousemove', scratch);
        canvas.addEventListener('touchmove', scratch);
        canvas.addEventListener('mouseup', endScratch);
        canvas.addEventListener('touchend', endScratch);

        // ×‘×“×™×§×” ×›××” ×’×•×¨×“
        function checkScratchPercent() {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const pixels = imageData.data;
            let transparentPixels = 0;
            
            for (let i = 3; i < pixels.length; i += 4) {
                if (pixels[i] === 0) transparentPixels++;
            }
            
            const percent = (transparentPixels / (pixels.length / 4)) * 100;
            
            if (percent > 40) { // ×× ×’×™×¨×“×• ××¢×œ 40%
                canvas.style.transition = 'opacity 0.5s';
                canvas.style.opacity = '0';
                setTimeout(() => {
                    canvas.style.display = 'none';
                    showActions();
                }, 500);
            }
        }

        function showActions() {
            const actions = document.getElementById('actions');
            actions.classList.remove('pointer-events-none');
            actions.classList.remove('opacity-0');
            document.getElementById('instructions').innerText = "×›×œ ×”×›×‘×•×“! ×©××¨×ª ×¢×œ ×”×¨×¦×£ ğŸ”¥";
            
            // ××¤×§×˜ ×¨×˜×˜ ×œ×”×¦×œ×—×”
            if (navigator.vibrate) navigator.vibrate([100, 50, 100]);
        }

        function shareQuote() {
            const text = `×”×™×•× ×”×•× ×™×•× ${localStorage.getItem('streak')} ×©×œ×™ ×‘×¨×¦×£! ğŸ”¥\n×”××¡×¨ ×©×œ×™ ×œ×”×™×•×:\n"${dailyQuote}"\n\n×‘×•××• ×œ×”×ª×—×™×œ ×¨×¦×£ ××©×œ×›×: ${window.location.href}`;
            if (navigator.share) {
                navigator.share({ title: '×”×’×¨×“ ×”×™×•××™', text: text });
            } else {
                window.open(`https://wa.me/?text=${encodeURIComponent(text)}`);
            }
        }
    </script>
</body>
</html>


